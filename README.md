
## å‰è¨€


æœ¬æ–‡è®°å½•ä¸€ä¸‹ StarBlog é¡¹ç›®çš„å½“å‰çŠ¶æ€ä¸æ¥ä¸‹æ¥ v2 ç‰ˆæœ¬çš„å¼€å‘è§„åˆ’ã€‚


StarBlog é¡¹ç›®ä» 2022 å¹´å¼€å§‹è‡³ä»Šå·²ç» 2 å¹´å¤šäº†ï¼Œæœ¬æ¥æ—©å°±è¯¥ç»™ç¬¬ä¸€æœŸåšä¸ªå°ç»“çš„ï¼Œä½†è¿™ç§åšå®¢ç±»å‹çš„é¡¹ç›®ï¼Œä¸€æ—¦ç¨³å®šèƒ½ç”¨ä¹‹åï¼Œæˆ‘å°±æ²¡å¤šå¤§çš„åŠ¨åŠ›å»æ›´æ–°äº† ğŸ˜‚


åšå®¢åœ°å€æ˜¯: [blog.deali.cn](https://github.com)


å¦å¤–è¿˜æœ‰ä¸ªç”¨ NextJS é‡æ„çš„[é¢„è§ˆç‰ˆ](https://github.com):[è±†èšåŠ é€Ÿå™¨å®˜ç½‘PodHub](https://doujiaa.com)



> PSï¼šå¯¹äº†ï¼Œè¿˜æœ‰ä¸ª StarBlog çš„ Vue å‰ç«¯ç³»åˆ—ï¼Œæˆ‘ä¹‹å‰å·²ç»å†™å¥½äº†ï¼Œä¸€ç›´æ²¡æœ‰å‘å‡ºæ¥ï¼Œæ¥ä¸‹æ¥ä¼šè¿è½½æ›´æ–°ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å…³æ³¨ä¸€ä¸‹ã€‚
> 
> 
> å†…å®¹æ¯”è¾ƒç®€å•ï¼ˆå½“æ—¶æˆ‘æ˜¯è¾¹å­¦ Vue è¾¹åšçš„ï¼‰ï¼Œä¸è¿‡ä»è¿™ä¸ªè§’åº¦æ¥è¯´ä¹ŸæŒºé€‚åˆåˆšå…¥é—¨çš„åŒå­¦é˜…è¯»ï¼Œæ¯•ç«Ÿä»¥åˆå­¦è€…çš„è§’åº¦å†™çš„ã€‚


å½“æ—¶å¼€å‘è¿™ä¸ªé¡¹ç›®çš„æœ¬æ„æ˜¯è¾¹å­¦è¾¹åšï¼Œä½œä¸ºç†Ÿæ‚‰ AspNetCore çš„ç»ƒæ‰‹é¡¹ç›®ï¼Œç°åœ¨è¯´å®è¯ä¹Ÿæ— æ³•æŠ•å…¥å¾ˆå¤šæ—¶é—´å»å¼€å‘è¿™ç±»åšå®¢é¡¹ç›®äº†â€¦â€¦æ¯•ç«Ÿè¿™ç§ç±»å‹çš„é¡¹ç›®å¤ªåŸºç¡€äº†ã€‚


è¿˜è®°å¾—æˆ‘å¹´åˆè§„åˆ’çš„å‡ ä¸ªæ–°é¡¹ç›®ï¼Œåˆ°ç°åœ¨çš„è¿›åº¦éƒ½è¿˜å¾ˆæœ‰é™ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥è¿˜æ˜¯å¾—æŠŠæ—¶é—´æ”¾åœ¨è¿™äº›æ–°é¡¹ç›®ä¸Šã€‚


è¿™é‡Œæ¥å›é¡¾ä¸€ä¸‹æ–°é¡¹ç›®å¼€å‘è®¡åˆ’ï¼š


* StarSSO \- å•ç‚¹è®¤è¯æœåŠ¡
* EchoSubs \- è§†é¢‘å­—å¹•è¯†åˆ«ã€ç¿»è¯‘æœåŠ¡
* SnapMix \- éšæœºå›¾ç‰‡æ¥å£æœåŠ¡
* AIHub 2\.0 \- AIHub çš„å‡çº§ç‰ˆ
* StarBlogHub \- å®ç°ä¸€ä¸ªå»ä¸­å¿ƒåŒ–çš„åšå®¢èšåˆå¹³å°ï¼Œä¸åŒçš„ä¸ªäººåšå®¢éƒ½å¯ä»¥æ¥å…¥ï¼Œå…±äº«æµé‡
* TodayTV \- çœ‹ç”µè§†ï¼Œç”¨äºä»£æ›¿ä¼ ç»Ÿçš„ç”µè§†ç›´æ’­
* Clipify \- åŸºäº Blazor çš„è§†é¢‘å‰ªè¾‘å·¥å…·ï¼Œå·²å¼€æº


è¿™ä¹ˆçœ‹ä¸‹æ¥ä¹Ÿå¤ªå¤šäº†ï¼Œæ‘Šå­é“ºå¤ªå¤§äº†ï¼Œä¸å¥½æ”¶åœºå•Šâ€¦


ä¸è¿‡ç²¾åŠ›æ”¾åœ¨å…¶ä»–é¡¹ç›®ä¸Šä¹Ÿä¸æ˜¯æ„å‘³ç€ä¸ç®¡ StarBlog é¡¹ç›®äº†ï¼Œäº‹å®ä¸Šæˆ‘ä¸€ç›´æœ‰åœ¨åšå°ä¿®å°æ”¹ï¼Œè¿™ä¸ªçœ‹ Github commit å°±çŸ¥é“äº†ã€‚


## å½“å‰ç‰ˆæœ¬çš„ä¸è¶³ä¹‹å¤„


ä» StarBlog é¡¹ç›®ä¸Šçº¿è‡³ä»Šï¼Œæˆ‘ä¸æ–­å­¦ä¹ å…³äº AspNetCore çš„ç»†èŠ‚çŸ¥è¯†ï¼Œç›¸æ¯”èµ·åˆšåˆšå¼€å‘è¿™ä¸ªé¡¹ç›®çš„æ—¶å€™ï¼Œå¯¹æ¡†æ¶çš„ç†Ÿæ‚‰ç¨‹åº¦æå‡äº†ä¸€äº›ï¼Œè‡ªç„¶ä¹Ÿå‘ç°äº†ä¹‹å‰ä»£ç é‡Œçš„å±€é™ä¹‹å¤„ï¼š


* å¢åˆ æ”¹æŸ¥çš„ã€ŒæŸ¥ã€åº”è¯¥ä½¿ç”¨ patch æ–¹æ³•
* åœ¨ Get æ–¹æ³•æ¥å£åŠ ä¸Š `[HttpHead]` æ¥å®ç°å¯¹ Head æ–¹æ³•çš„æ”¯æŒ
* è¿‡æ»¤å’Œæœç´¢çš„æ¥å£éœ€è¦å¯¹å‚æ•°è¿›è¡Œ trim
* ä¸åº”è¯¥å°†æ¥å£çš„è¿”å›å€¼éƒ½ä¿®æ”¹ä¸º `ApiResponse` ç±»å‹ï¼Œåº”è¯¥ä¿ç•™æ¡†æ¶çš„ `ActionResult` ç±»å‹ï¼Œè¿™æ ·åŠŸèƒ½æ›´å¤š
* åªç»Ÿä¸€äº†æ¥å£çš„è¿”å›å€¼ï¼Œæ²¡æœ‰å¯¹å¼‚å¸¸è¿›è¡ŒåŒ…è£…ï¼Œåº”è¯¥ä½¿ç”¨ `app.UseExceptionHandler` ä¸­é—´ä»¶æ¥å®ç°ç»Ÿä¸€é”™è¯¯å¤„ç†ï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨å¼‚å¸¸è¿‡æ»¤å™¨ï¼‰
* å¯¹ markdown çš„ tocã€å…¬å¼ã€ä»£ç å—ã€è¡¨æ ¼åµŒå¥—å›¾ç‰‡ç­‰è¿˜æ˜¯æ”¯æŒä¸ä½³


è¿™äº›é—®é¢˜å°†æ˜¯ v2 ç‰ˆæœ¬è¦è§£å†³çš„ã€‚


## v2 æ–°ç‰ˆè§„åˆ’


ç›®å‰è§„åˆ’äº†ä¸€äº›æ–°çš„åŠŸèƒ½å’Œä¼˜åŒ–ï¼Œä½†è¿™è‚¯å®šä¸æ˜¯ v2 ç‰ˆæœ¬çš„å…¨éƒ¨ï¼Œå„ä½åŒå­¦å¦‚æœæœ‰å¥½çš„å»ºè®®ä¹Ÿå¯ä»¥ç•™è¨€è®¨è®ºä¸€ä¸‹\~


### åšå®¢å‰å°é‡æ„


* ä½¿ç”¨ Next.js é‡æ„
* ä½¿ç”¨ nodejs æŠ€æœ¯æ ˆçš„ markdown è§£æ


### ç®¡ç†åå°é‡æ„


* ä½¿ç”¨åŸºäº react çš„æŠ€æœ¯æ ˆé‡æ„


### æ–°çš„è®¿é—®ç»Ÿè®¡åŠŸèƒ½


* åœ°ç†ä¿¡æ¯å¯è§†åŒ–
* æœç´¢å¼•æ“æ”¶å½•åˆ†æ
* åçˆ¬è™«åŠŸèƒ½
* æ–‡ç« é˜…è¯»é‡ç»Ÿè®¡


### æ–‡ç« ç¼–è¾‘åŠŸèƒ½


* ä½¿ç”¨æ–°çš„ markdown ç¼–è¾‘å™¨ï¼ˆæœ€å¥½åƒ wagtail é‚£æ ·æ‰€è§å³æ‰€å¾—çš„ï¼‰
* æ”¯æŒåœ¨æ–‡ç« ä¸­åŠ å…¥æ›´å¤šå†…å®¹ï¼ˆå¦‚è§†é¢‘ï¼‰


### æ–‡ç« é˜…è¯»ä½“éªŒä¼˜åŒ–


* ä½¿ç”¨æ–°çš„ markdown æ¸²æŸ“å·¥å…·ï¼ˆç›®å‰ä½¿ç”¨çš„æ˜¯æˆ‘ fork é­”æ”¹çš„ editor.mdï¼Œç”¨èµ·æ¥è¿˜å¯ä»¥ï¼Œä½†è¿™ä¸ªå·¥å…·å¾ˆè€äº†ï¼Œè€Œä¸”ä¹Ÿåœæ›´äº†ï¼Œæˆ‘å¸Œæœ›æ‰¾ä¸€ä¸ªç»´æŠ¤è‰¯å¥½æ›´ç°ä»£çš„æ¸²æŸ“å·¥å…·æ¥æ›¿ä»£ï¼‰


### æ–‡ç« åŠ å¯†


* è®¾ç½®å›ºå®šå¯†ç 
* å…³æ³¨å…¬ä¼—å·è·å–åŠ¨æ€å¯†ç 


### æ–°ç‰ˆæœç´¢åŠŸèƒ½


* ä½¿ç”¨å…¨æ–‡æ£€ç´¢å¼•æ“
* åŠ å…¥ Embedding


### AI åŠŸèƒ½


* çŸ¥è¯†åº“
* å¯¹è¯åŠŸèƒ½
* æ–‡ç«  AI æ€»ç»“
* è‡ªåŠ¨è¯„è®º


## AspNetCore æ¸©æ•…çŸ¥æ–°


24 å¹´åˆæˆ‘åˆå¤ä¹ äº†ä¸€äº› AspNetCore æ¡†æ¶çš„åŠŸèƒ½ï¼Œæ¯”è¾ƒé›¶æ•£ä¸æˆä½“ç³»ï¼Œä¸ StarBlog çš„å¼€å‘æ˜¯æ¯æ¯ç›¸å…³çš„ï¼Œæ‰€ä»¥åœ¨æœ¬æ–‡è®°å½•ä¸€ä¸‹å§\~


### ç»Ÿä¸€é”™è¯¯å¤„ç†


#### å¼‚å¸¸è¿‡æ»¤å™¨


ç¼–å†™è¿‡æ»¤å™¨



```
public class ApiExceptionFilter : IExceptionFilter {
  public void OnException(ExceptionContext context) {
    var response = new ApiResponse {
      StatusCode = 500,
      Successful = false,
      // å¯ä»¥æ ¹æ®éœ€æ±‚ä¿®æ”¹æ­¤å¤„æ¥æ›´è¯¦ç»†åœ°æè¿°é”™è¯¯ä¿¡æ¯
      Message = context.Exception.Message
    };

    context.Result = new ObjectResult(response) {
      StatusCode = 500
    };

    // æ ‡è®°å¼‚å¸¸å·²å¤„ç†
    context.ExceptionHandled = true;
  }
}

```

æ³¨å†Œ



```
builder.Services.AddControllers(options => {
  options.Filters.Add();
  options.Filters.Add();
});

```

è¿‡æ»¤å™¨å¯ä»¥æ•è·åœ¨ Action æ–¹æ³•æˆ–æ§åˆ¶å™¨ä¸­æŠ›å‡ºçš„å¼‚å¸¸ï¼Œå¹¶å…è®¸å¼€å‘è€…å¯¹å…¶è¿›è¡Œå¤„ç†ï¼Œç„¶åè¿”å›ä¸€ä¸ªç»Ÿä¸€çš„å“åº”æ ¼å¼ã€‚


ä½†ä¸æ˜¯åœ¨ Action æ–¹æ³•æˆ–æ§åˆ¶å™¨ä¸­æŠ›å‡ºçš„å¼‚å¸¸ï¼Œæ˜¯æ•è·ä¸åˆ°çš„ï¼Œä¾‹å¦‚åŠ äº† `[Authorize]` ç‰¹æ€§çš„æ¥å£ï¼Œæ²¡æœ‰æä¾›è®¤è¯ä¿¡æ¯çš„æ—¶å€™è®¿é—®æŠ¥ 401 é”™è¯¯ï¼Œè¿™ç§æ˜¯æ•è·ä¸åˆ°çš„ã€‚


#### ä¸­é—´ä»¶


å¦‚æœæƒ³è¦åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­å¤„ç†å¼‚å¸¸ï¼Œä½¿ç”¨ä¸­é—´ä»¶å¯èƒ½æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚ä¸­é—´ä»¶å¯ä»¥æ•è·åœ¨è¯·æ±‚å¤„ç†ç®¡é“ä¸­å‘ç”Ÿçš„æ‰€æœ‰ç±»å‹çš„å¼‚å¸¸ã€‚


ä½¿ç”¨ `app.UseExceptionHandler` ä¸­é—´ä»¶æ¥å®ç°ç»Ÿä¸€é”™è¯¯å¤„ç†


ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œåœ¨ `Program.cs` é‡Œé…ç½®å†…ç½®çš„ `ExceptionHandler` ä¸­é—´ä»¶



```
if (app.Environment.IsDevelopment()) {
  app.UseDeveloperExceptionPage();
}
else {
  app.UseExceptionHandler(applicationBuilder => {
    applicationBuilder.Run(async context => {
      // è®°å½•æ—¥å¿—å•¥çš„
      context.Response.StatusCode = StatusCodes.Status500InternalServerError;
      await context.Response.WriteAsJsonAsync(new { message = "Unexpected error!" });
    });
  });
}

```

è‡ªå·±æ‰‹å†™ä¸­é—´ä»¶



```
public class ErrorHandlingMiddleware {
  private readonly RequestDelegate _next;

  public ErrorHandlingMiddleware(RequestDelegate next) {
    _next = next;
  }

  public async Task Invoke(HttpContext context) {
    try {
      await _next(context);
    }
    catch (Exception ex) {
      await HandleExceptionAsync(context, ex);
    }
  }

  private static Task HandleExceptionAsync(HttpContext context, Exception exception) {
    var response = new ApiResponse {
      StatusCode = 500,
      Successful = false,
      Message = exception.Message
    };

    context.Response.ContentType = "application/json";
    context.Response.StatusCode = (int)HttpStatusCode.InternalServerError;
    return context.Response.WriteAsync(JsonConvert.SerializeObject(response));
  }
}

```

ä½¿ç”¨ä¸­é—´ä»¶



```
app.UseMiddleware();

```

### è‡ªå®šä¹‰è®¤è¯æˆæƒç›¸å…³çš„è¿”å›å€¼


åœ¨ ASP.NET Core ä¸­ï¼Œå½“ä½¿ç”¨ `app.UseAuthentication()` å’Œ `app.UseAuthorization()` ä¸­é—´ä»¶å¤„ç†è®¤è¯å’Œæˆæƒé€»è¾‘æ—¶ï¼Œå¦‚æœè®¤è¯æˆ–æˆæƒå¤±è´¥ï¼Œè¿™äº›ä¸­é—´ä»¶ä¼šç›´æ¥ä¿®æ”¹å“åº”ï¼Œè¿”å› HTTP çŠ¶æ€ç å¦‚ 401ï¼ˆæœªè®¤è¯ï¼‰æˆ– 403ï¼ˆæœªæˆæƒï¼‰ã€‚


è¿™äº›å“åº”å¹¶ä¸æ˜¯é€šè¿‡å¼‚å¸¸æœºåˆ¶å¤„ç†çš„ï¼Œå› æ­¤å¸¸è§„çš„å¼‚å¸¸å¤„ç†ä¸­é—´ä»¶æˆ– `UseExceptionHandler` æ— æ³•æ•è·å’Œä¿®æ”¹è¿™äº›ç‰¹å®šçš„é”™è¯¯å“åº”ã€‚


è¦è‡ªå®šä¹‰è¿™äº›é”™è¯¯å“åº”ï¼Œéœ€è¦é…ç½®è®¤è¯ä¸­é—´ä»¶ä»¥ä½¿ç”¨ç‰¹å®šçš„äº‹ä»¶æ¥ä¿®æ”¹å“åº”ã€‚


è¿™é€šå¸¸æ¶‰åŠåˆ°åœ¨è®¤è¯æ–¹æ¡ˆçš„é…ç½®ä¸­æ·»åŠ äº‹ä»¶å¤„ç†é€»è¾‘ã€‚ä¸‹é¢ä»¥ JWT è®¤è¯ä¸ºä¾‹è¯´æ˜å¦‚ä½•è‡ªå®šä¹‰ 401 å’Œ 403 çš„å“åº”ï¼š


#### é…ç½® JWT è®¤è¯ä»¥è‡ªå®šä¹‰ 401 å’Œ 403 å“åº”


åœ¨ `services.AddAuthentication().AddJwtBearer(options => { ... })` é‡Œé¢æ·»åŠ äº‹ä»¶é…ç½®



```
options.Events = new JwtBearerEvents {
  OnChallenge = async context => {
    if (!context.Response.HasStarted) {
      context.HandleResponse(); // é˜»æ­¢é»˜è®¤çš„401å“åº”
      var response = new ApiResponse {
        StatusCode = 401,
        Successful = false,
        Message = "Authentication failed. You are not authorized."
      };
      context.Response.ContentType = "application/json";
      await context.Response.WriteAsync(JsonConvert.SerializeObject(response));
    }
  },
  OnForbidden = async context => {
    var response = new ApiResponse {
      StatusCode = 403,
      Successful = false,
      Message = "You do not have permission to access this resource."
    };
    context.Response.ContentType = "application/json";
    await context.Response.WriteAsync(JsonConvert.SerializeObject(response));
  }
};

```

åœ¨ JWT è®¤è¯æµç¨‹ä¸­ï¼Œ`JwtBearerEvents` ç±»æä¾›äº†å¤šä¸ªäº‹ä»¶æ¥å¤„ç†ä¸åŒçš„è®¤è¯ç›¸å…³æƒ…æ™¯ï¼š


1. **OnChallenge** \- è¿™ä¸ªäº‹ä»¶æ˜¯åœ¨è®¤è¯å¤±è´¥æ—¶è§¦å‘çš„ï¼Œé€šå¸¸æ˜¯å› ä¸ºè¯·æ±‚ä¸­æ²¡æœ‰æä¾›æœ‰æ•ˆçš„ JWT ä»¤ç‰Œã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¯·æ±‚æ²¡æœ‰åŒ…å«ä»¤ç‰Œï¼Œæˆ–è€…ä»¤ç‰Œä¸ç¬¦åˆé¢„æœŸçš„æ ¼å¼ï¼Œæˆ–è€…ä»¤ç‰Œå·²è¿‡æœŸç­‰æƒ…å†µï¼Œéƒ½ä¼šè§¦å‘æ­¤äº‹ä»¶ã€‚`OnChallenge` äº‹ä»¶æ˜¯å¤„ç†è¿”å› 401 æœªè®¤è¯å“åº”çš„æ­£ç¡®ä½ç½®ã€‚
2. **OnAuthenticationFailed** \- è¿™ä¸ªäº‹ä»¶åœ¨è®¤è¯è¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸æ—¶è§¦å‘ã€‚è¿™é€šå¸¸æ¶‰åŠåˆ°ä»¤ç‰Œè§£ææˆ–éªŒè¯ä¸­å‡ºç°çš„é”™è¯¯ï¼Œæ¯”å¦‚ä»¤ç‰Œè¢«ç¯¡æ”¹ã€‚åœ¨æ­¤äº‹ä»¶ä¸­ï¼Œä½ å¯ä»¥è®°å½•å¼‚å¸¸æˆ–ä¿®æ”¹è®¤è¯å¤±è´¥æ—¶çš„å¤„ç†é€»è¾‘ã€‚
3. **OnForbidden** \- å½“ç”¨æˆ·é€šè¿‡äº†è®¤è¯ä½†æ˜¯ä¸ç¬¦åˆç‰¹å®šçš„æˆæƒæ¡ä»¶æ—¶è§¦å‘ã€‚ä¾‹å¦‚ï¼Œç”¨æˆ·çš„è§’è‰²æˆ–æƒé™ä¸è¶³ä»¥è®¿é—®æŸä¸ªèµ„æºã€‚åœ¨æ­¤äº‹ä»¶ä¸­ï¼Œä½ å¯ä»¥è‡ªå®šä¹‰è¿”å› 403 ç¦æ­¢è®¿é—®çš„å“åº”ã€‚


### è‡ªå®šä¹‰æ¨¡å‹ç»‘å®š


å®ç° `IModelBinder` æ¥å£å¯ä»¥è‡ªå®šä¹‰æ¥å£çš„ model bind è¡Œä¸ºï¼Œè¿™ç§å«åš `Custom Model Binder`ï¼Œå»ºè®®æ”¾åœ¨ `Helpers` ç›®å½•ä¸‹


ä¾‹å­ï¼šè¾“å…¥ `guid1,guid2,guid3,guid4` å½¢å¼çš„å‚æ•°ï¼Œè·å–å…¬å¸åˆ—è¡¨



```
[HttpGet("{ids}")]
public async Task GetCompanyCollection([FromRoute] IEnumerable ids) {
}

```

æ–°å¢ `Helpers/ArrayModelBinder.cs` æ–‡ä»¶



```
public class ArrayModelBinder : IModelBinder {
  public Task BindModelAsync(ModelBindingContext bindingContext) {
    if (!bindingContext.ModelMetadata.IsEnumerableType) {
      bindingContext.Result = ModelBindingResult.Failed();
      return Task.CompletedTask;
    }

    var value = bindingContext.ValueProvider.GetValue(bindingContext.ModelName).ToString();
    if (string.IsNullOrWhiteSpace(value)) {
      bindingContext.Result = ModelBindingResult.Success(null);
      return Task.CompletedTask;
    }

    // ä½¿ç”¨åå°„è·å–å‚æ•°ç±»å‹
    var elementType = bindingContext.ModelType.GetTypeInfo().GenericTypeParameters[0];

    // æ ¹æ®å‚æ•°ç±»å‹ï¼Œæ–°å»ºä¸€ä¸ªç±»å‹è½¬æ¢å™¨
    var converter = TypeDescriptor.GetConverter(elementType);

    // æŒ‰ç…§ , åˆ†å‰²å­—ç¬¦ä¸²ï¼Œ
    // æŒ‡å®š `StringSplitOptions.RemoveEmptyEntries` å‚æ•°ï¼Œç”¨ä»¥æ¸…é™¤åˆ†å‰²åçš„ç©ºå€¼ï¼Œæ¯”å¦‚ `1,,3,4` -> `["1", "3", "4"]`
    var values = value.Split(new[] { "," }, StringSplitOptions.RemoveEmptyEntries)
      .Select(x => converter.ConvertFromString(x.Trim()))
      .ToArray();

    var typedValues = Array.CreateInstance(elementType, values.Length);
    values.CopyTo(typedValues, 0);
    bindingContext.Model = typedValues;

    bindingContext.Result = ModelBindingResult.Success(bindingContext.Model);

    return Task.CompletedTask;
  }
}

```

æœ€ååœ¨æ¥å£ç­¾åé‡ŒæŒ‡å®šä½¿ç”¨çš„ `ModelBinder`



```
[HttpGet("{ids}")]
public async Task GetCompanyCollection(
  [FromRoute]
  [ModelBinder(BinderType = typeof(ArrayModelBinder))]
  IEnumerable ids) {
}

```

PSï¼šä¸ºäº†æ›´ç›´è§‚è¡¨ç¤ºå‡ºè¿™ä¸ª route parameter æ˜¯æ”¯æŒä¼ å…¥å¤šä¸ªå€¼ï¼Œå¯ä»¥åœ¨å‚æ•°ä¸ŠåŠ ä¸ªæ‹¬å·ã€‚



```
[HttpGet("({ids})")]
public async Task GetCompanyCollection(

```

## å°ç»“


ä¸çŸ¥é“è¯´å•¥ï¼Œç°åœ¨å¾ˆå°‘å†™ C\#äº†ï¼Œæœ€è¿‘.Net9 å¥½åƒå‡ºæ¥äº†ï¼Œä¼˜åŒ–äº† GC ç®—æ³•ï¼Œç­‰æœ‰ç©ºæ¥è¯•è¯•\~


